# statistics_11

### 질문 피드백

- 다중 공선성 vs. 통계적으로 통제  → 사진 참고

    모델링(여기선 linear regression이라고 하면)을 하다 변수들의 다중공선성을 확인하고 싶으면 
    어떻게 확인해야 하나요??
    옆에서 공부하시는 분이 물어봐서 확인차 질문 드립니다 -->>보민님ㅋㅋ
    res = ols('Aggression ~ Television + Computer_Games + Sibling_Aggression + Diet + Parenting_Style ',child).fit()
    res = ols('Aggression ~ Television ',child).fit()
    ->> 결과
    Televison을 단독으로 aggrssiveness에 대한 독립변수로 modeling 했을때는 유의한 의미가 있었는데,  
    Television , Computer_Games , Sibling_Aggression, Diet, Parenting_Style (존재하는 모든 독립변수)를 다 때려박으니 Television이 의미가 없어졌다.
    ->> 해석
    Computer_Games , Sibling_Aggression, Diet, Parenting_Style을 "통계적으로 통제"했을 때, TV의 공격성은 아동의 공격성을 설명할 수 없다.
    즉, Computer_Games , Sibling_Aggression, Diet, Parenting_Style에 의해 TV는 간접적으로 아동의 공격성에 영향을 주는 것 이었구나~
    인데,,
    television과 다중공선성이 일어나는 변수를 찾기 위해서는 television에 간접적으로 영향을 주는 모든 변수들에 대해 상관관계를 구하면 되나요??? 
    아니면,, 분산확대인자(vif: 1 / 1-R^2)라는 지표도 들어봤는데...  이걸 이용하려나요??

- vif는 계산 방식이 다른 거 (r제곱을 해야 vif도 구할 수 있음) - 10정도에서 자름
- 결국 vif든 r제곱이든 독립변수 끼리 회귀할 때는 vif, 독립변수끼리 너무 서로 예측이 잘 되면 다중공선성 문제가 있으니까 vif로 해주는 거
- 통계적으로 통제하는 거?
    - 노트 필기 참고!
    - 문제상황 이라기 보단 우리가 그냥 분석하는 거

# 생존분석 survival analysis

- 특정 사건(예: 죽음, 회복, 고장, 가입, 이탈 등)까지 걸리는 기간을 분석
- 보험 업계와 의학계에서 발전한 기법이기에 이러한 이름이 붙음
    - 가입을 할 때까지 걸리는 시간
    - 유저가 이탈할 때까지 걸리는 시간

# 센서링 Cencoring

- 조사 기간 밖에서 죽는 경우
- **Right censoring**: **조사 기간 이후 언젠가에 죽는 경우** - 제일 흔함
    - 연구 종료 이후에 event가 생길 수도 있는 센서링. 연구 종료 시점 오른쪽을 모름
    - 가장 일반적인 censoring의 의미이다. censoring하면 보통 right censoring을 의미하는 경우가 많다.
    - 연구자는 어떤 연구 참여자를 평생 관찰할 수 없다. 예를 들어, 흡연자와 비흡연자의 폐암 발생까지의 시간을 비교하는 연구를 해본다고 해보자. 흡연자가 생각보다 건강해서 100살 넘도록 살수도 있을 것이다. 하지만 100년 넘도록 폐암의 발생여부를 주기적으로 관찰하는 것은 매우 어렵다. 따라서 적절한 시점에서 연구 종료를 선언하고, 지금까지 수집된 정보를 바탕으로 흡연자와 비흡연자를 비교하는 것이 적절할 것이다. 또는 중간에 폐암이 아닌 다른 원인으로 사망한다거나, 더 이상의 연구 참여를 하지 않겠다고 통보할 수도 있다. 이러한 경우를 right censoring 이라 한다.
    - 즉, right censoring이 발생하는 경우는 다음과 같은 상황을 예로 들어볼 수 있다. -> 스터디의 종료, 관심 event가 아닌 이유로 사망, 중도탈락
    - 실제 분석 시, right censoring 이 있는 경우, 그 사람의 정보가 어떤 특정시점 t까지는 available 한 것을 이용하게 된다. 이러한 right censoring을 활용하는 것이 생존분석의 강점이라고 할 수 있다.

        출처: [https://3months.tistory.com/349](https://3months.tistory.com/349)[Deep Play]

- Left censoring: 조사 기간 이전 언젠가에 죽은 경우
    - 연구 기간 이전에 더 앞선 시기 (데이터에 포함은 되어있는 데 정확하게 '언제'를 모름
    - 내가 조사를 시작하기 전에 언제 가입이 되어있는 지 기록이 없음 → Missing
    - 만약, 나무늘보가 언제 나무에서 내려오는지를 관찰하려고 한다. 근데 나무늘보는 항상 사람이 잠드는 새벽시간에만 땅으로 내려온다고 해보자 (예를 들어, 5am 정도). 그리고 사람은 아침 9시에 일어나서 나무늘보를 관찰한다. 그렇다면 사람은 평생 나무늘보다 땅으로 내려오는 것을 관찰할 수 없을지도 모른다. 이는 관찰기간 (9am~) 보다 event의 발생시각(5am) 이 전에 있기 때문이다.
    - 언제 담배를 처음 피었는가?
    - 치매의 발생 (언제 정확히 발생했는지 알기 힘들다.

        출처: [https://3months.tistory.com/349](https://3months.tistory.com/349)[Deep Play]

- Left truncation: 조사 이전에 죽어서 조사에 포함도 안되는 경우
    - 의외로 꽤 있는 문제 - 애초에 데이터에도 안 들어 올 수 있음 (특히 시간과 연결될 경우)
    - 내가 조사하기도 전에 탈퇴가 되어서 데이터가 아예 없음. 조사해도 모음 → Delete
- Interval censoring: 두 관찰 시점 사이 언젠가에 죽은 경우
    - 짧은 기간 내 센서링을 하면 문제가 많이 생김

# 생존함수 survival function

- 시점 t까지 살아남을(죽지 않을) 확률
- 𝑆 (𝑡) = 𝑃 (𝑇 > 𝑡)
- T: 죽는 시점
- 추세를 파악할 정도만 관찰하면 뒤는 짤려 있어도 나머지는 이을 수 있음
- 그렇기 때문에 생존함수를 추정하면 훨씬 더 정보를 많이 가질 수 있다
- 1) 생존함수의 예 → 그림 그려보기
- 2) 액션(정책) → 더 나은 그래프를 만들려면..?

# 카플란 마이어 추정치 Kaplan-Meier estimate

![](Untitled-c415c055-68b8-422b-bf76-50b2560e5163.png)

- 𝑡𝑖 : i번째 시점
- 𝑛𝑖 : i번째 시점까지 살아남은 수
- 𝑑𝑖 : i번째 시점에 죽은 수
- ex) 살아남은 수 - 죽은 사람 수 / 살아남은 수
    - i 번째 시점에서의 살아남은 사람 퍼센트
    - 문처럼 생긴 기호: 프로덕트 (다 곱하는 거)

# 위험 함수 hazard function

- 시점 t에 죽을 확률
- 생존함수는 시점 t까지 생존할 확률인 반면 위험함수는 시점 t에 죽을 확률
- S(t) = .5 → t까지 50%가 살아남는다
- h(t) = .5 → 시점 t에 그때까지 살아있던 사람 중에 50%가 죽는다

# 누적 위험 함수 Cumulative Hazard Function

- 시점 0부터 시점 t까지 위험 함수의 적분(=합계)
- 위험 함수 = 시점 t에서 누적 위험 함수의 변화량
- 생존 함수 S(t) = exp(-H(t))
- 위험 함수는 시점 t의 순간적인 변화이기 때문에 추정이 어려움
- 누적 위험 함수는 해석이 어렵지만 긴 시점의 누적된 양이므로 상대적으로 추정이 쉬움

### 차원 축소 → 평균점수 / pca(분산)-시각화/ nmf/요인 분석/mds

# 넬슨 알렌 추정치 Nelson-Aalen estimate

- 누적 위험 함수 H(t)의 추정치

![](Untitled-858e1b67-f5db-402d-84ef-e7d00d24c911.png)

- 𝑡𝑖 : i번째 시점
- 𝑛𝑖 : i번째 시점까지 살아남은 수
- 𝑑𝑖 : i번째 시점에 죽은 수

# 지수 모형 Exponential model

- 람다(λ), 한 가지 파라미터로 누적위험함수를 나타냄
- 𝐻 (𝑡) = 𝑡/𝜆
- 매 시점마다 1/λ의 확률로 일정하게 죽는 것을 가정

- 지수모형은 너무 단순하다 그렇게 나올리가 있냐, 해서 나온게 베이불 모형
- 지수모형보단 더 다양한 형태를 나타낼 수 있음

# 베이불 모형 Weibull model

- 람다(λ)와 로(ρ), 두 가지 파라미터로 누적위험함수를 나타냄
- 지수 모형과 비슷하나 더 복잡한 패턴을 나타낼 수 있음

![](Untitled-724dac96-bb7f-416e-96b2-6bfc39da97ce.png)

### 시점 (시각화로 둘 다 겹쳐보기)

- KM → 생존함수 → plot
- weibull → 누적위험 →  위험→  생존
- 그래서 파란 구간(km): 실제 데이터를 많이 활용해서 구불구불, weibull은 매끄러움

# 생존 회귀 survival regression

- 위험(hazard)을 종속변수로 회귀 분석
- 회귀 분석 + 생존 분석

# 콕스 모형 cox model

- 기준 위험 대비 비율로 예측
- 기준 위험(베이불로 예측 → 기본 커브를 찾음)

![](Untitled-084fa2aa-0549-42dd-b1cc-ed36e587645b.png)

- 𝑏0 𝑡 : 시점 t의 기저선 위험(baseline hazard)

# 위험비 hazard ratio

- 위험이 증가하는 비율 (잡혀올 위험)
- 독립변수 x의 계수가 0.09인 경우 → exp(0.09) = 1.10
- x가 1 증가할 때마다 위험이 1.10배씩 증가 (위험이 얼마나 증가하나)
- 콕스 모형의 주요 가정: 위험은 시간에 따라 변하지만, 위험비는 일정하다

# 통계10 파일

# 다차원 척도법 MultiDimensional Scaling

- 사례들 사이의 유사도(거리)를 최대한 유지하는 방법
    - 예) 아이폰11, 갤럭시 s10, lg v50
        - 아이폰과 갤러시/갤럭시와 lg/아이폰과 lg 가 얼마나 비슷하다고 생각하나요 (1-5척도)
        - 
- 역으로 유사도만 존재하는 데이터를 시각화하는데 사용할 수도 있음
- metric: 절대적인 거리를 가능한 유지
- non-metric: 상대적인 거리만 유지

![](Untitled-1fcaea1b-e9cc-4697-8eec-72ebe4d6a7da.png)

- 이런식으로 그림 그릴 수 있음

# 복습 테스트

1. m은 학습 스타일을 나타내는 변수입니다. '언어형'(m=0)은 말로 설명하면서 공부하는 것을 선호합니다. '시각형'(m=1)은 그림을 그리면서 공부하는 것을 선호합니다. 학습 시간을 나타내는 변수가 x라고 할 때 x와 m으로 성적 y를 예측한다고 해봅시다. 이때 statsmodels에 입력하는 공식과 이에 대한 설명 중 옳은 것을 모두 고르세요. *

    **y ~ x + m 학습 스타일에 따라 성적의 절편이 다르다**

    **y ~ x + x:m 성적의 절편은 같지만 학습 스타일에 따라 같은 시간을 공부하더라도 성적이 오르는 정도가 다르다**

    **y = x + x:m + m 학습 스타일에 따라 성적의 절편도 다르고 같은 시간 공부하더라도 성적이 오르는 정도도 다르다**

    y = x * m 성적의 절편은 같지만 학습 스타일에 따라 같은 시간을 공부하더라도 성적이 오르는 정도가 다르다

2. 다음 중 클러스터링에 대한 설명으로 올바른 것을 **모두** 고르세요 *

    **클러스터링은 비슷한 사례들끼리 묶어 클러스터로 만드는 방법이다**

    **k-Means는 각 클러스터의 중심점(평균)을 찾는 방법이다.**

    **k-Means는 각 사례들이 클러스터의 중심에 몰려있을 때 유용하다.**

    **DBSCAN은 인접한 핵심점들끼리 연결하여 클러스터를 만드는 방법이다.**

    k-Means와 DBSCAN은 모두 클러스터의 개수를 미리 정해주어야 한다. 

    → dbscan은 미리 정해주는 게 아님

3. 데이터의 차원(dimension)에 대한 설명으로 옳은 것을 **모두** 고르세요. *

    **데이터의 차원이란 곧 변수의 개수이다.**

    **차원이 크면 시각화도 어렵고, 이해하거나 분석하기도 어렵다.**

    **여러 개의 변수를 적은 수의 변수로 줄이는 것을 차원 축소라고 한다**

    **여러 과목의 성적을 평균 내어 평균 점수로 만드는 것도 차원 축소라고 할 수 있다**

    **차원 축소에는 PCA, NMF, 요인분석 등의 기법이 있다**

4. 차원 축소 기법에 대한 설명으로 옳은 것을 모두 고르세요. *

    **PCA는 기존의 축을 회전 시켜 새로운 축을 만든다. 이때 축의 순서는 데이터에 설명하는 분산이 큰 순서대로 되도록 한다.**

    **NMF는 PCA와 비슷하지만 결과가 0 이상의 수로 나온다**

    탐색적 요인분석은 요인 구조를 분석가가 지정할 수 있다 → 확인적 요인분석의 요인구조를 분석가가 지정할 수 있음