# statistics_05

# 통계05

### 복습 테스트

1. **같은 모집단에서 샘플링을 하면, 할 때마다** *

    → 서로 다른 샘플을 얻게 된다.

**2. sampling distribution란** *

→ 샘플에서 구한 통계치가 샘플마다 어떻게 달라지는지 나타내는 분포이다

**3. 평균의 95% 신뢰구간이란 95%의 샘플에서 나올 수 있는 평균의 범위를 가리킨다** *

→ 참

→ 왜 95%? : 적당히 크다고 생각해서 

**4. 95% 신뢰구간을 구할 때는 보통 ***

→ 하위 2.5%와 상위 2.5%를 제외한 범위를 사용한다

**5. 샘플의 크기가 클 수록 신뢰구간은 ***

→  좁아진다

**6. 의사결정을 내리기 위해서는 신뢰구간은 충분히** *

→ 좁아야 한다

**7. 선형모형 y = ax + b에서 계수 a의 신뢰구간은** *

→ 마이너스든 플러스든 어느 한 쪽에만 있어야 한다

**8. 부트스트래핑은** *

→ 우리가 가진 샘플에서 다시 샘플링(리샘플링)을 반복하는 방법이다

**9. 부트스트래핑에서는 우리가 가진 샘플이 모집단을** *

→ 실제로 잘 반영하는지는 알 수 없지만, 잘 반영할 것이라고 가정한다

**10. 부트스트래핑은 샘플에서 리샘플링을 많이 하면** *

→ 신뢰구간을 정확히 알 수 있다

**11. 사이킷런의 resample 함수를 사용하여 df = resample(cars)와 같이 실행했습니다. 그 결과에 대해 옳은 것을 **모두** 고르세요** *

→ df와 cars의 크기는 같다

df와 cars의 평균은 같다 → 다르다! 

→ 부트스트래핑을 하여 신뢰구간을 구하려고 한다면 df를 바탕으로 통계치를 구해야 한다

**13. numpy.quantile(ms, .025)는 무엇을 구합니까?** *

→ 하위 2.5%의 위치

**14. 실험을 하고 신뢰구간을 구해봤더 신뢰구간이 우리가 필요로 하는 범위보다 넓었습니다. 무엇을 해야 합니까?** *

→ 더 많은 실험을 해서 샘플의 크기를 키운다

→ 일단 컴퓨터를 끄고 퇴근한다

# 실험

- 실험과 설문 : 실험 설계, 집단 간 비교, 효과 크기, 설문지 만들기
- MAB: 탐색과 활용의 교환, 멀티 암드 밴딧, 추천 시스템

## 예측

- 회귀 : 선형 모형의 심화와 해석
- 분류 : 로지스틱 선형 모형의 심화와 해석

# 상관과 인과

- 상관(correlation): 두 변수가 함께 움직이는 정도
- 상관은 인과(causation)가 아니다
- 예) 아이스크림 판매량과 범죄 발생 건수 → 그게 아니라 기온 때문

# 실험

- 인과를 확인하기 위한 **개입**
- 조건(condition): 실험자가 체계적으로 변화시키는 독립변수의 각 단계
- (최소한 두조건으론 나누어야 한다)

# 외생변수 : extraneous variables

- 실험의 독립/종속 변수가 아닌 변수
- 혼입 변수(confounding variable):
종속 변수에 영향을 미치는 외생 변수
- 일정 범위로 고정시키거나 통계적으로 통제
- ex)담배 → 암 인 효과를 보려고 a 집단은 담배를 피우고 b집단은 담배 안피게함

    외생변수 : 술→ 암  일때, 담배 안 피우는 b집단이 술을 마신다면 실험은 엉망징창 될 것 

# 종속 변수 고르기

- 실험의 목적을 고려 : 예) 고객 만족도는 중요한가?
- 매개변수(mediator) 사용
    - 독립변수 → 매개변수 → 종속변수
    - 예) 넷플릭스에서 고객 이탈률 vs. 사용 시간 (매개변수)
    - 프로모션 → 기분 업 (당장) < - > 재개약(2년)

# 실습

- 어떤 실험? 밤샘 공부를 하면 시험 결과에 미치는 영향
- 실험의 변수?
- 독립변수(조건) : (손목이 멀쩡한 사람들) 버티컬 마우스를 쓴다/안쓴다
- 외생변수: 손목에 무리가 가는 행동들 ex) 스마트폰 사용시간 통제
- 종속변수 ( 또는 매개변수)  손목 건강 상태
- 서비스개선/서비스 개선 안함 (독립변수) → 홈페이지 활성화 (매개변수) → 구매 (종속변수)
- 수면의 질: (독립변수로 개입 하기에 약간 애매함) → 외생 변수(전날 쉬었는 지, 카페인 섭취, 아침 식사, 날씨 등등 ... ) → 수업 집중도(종속변수)
- 독립변수 : 맥주 섭취 유무 → 외생변수 : 체중에 변화를 주는 요소 : 식이 요법 → 종속변수 : 체중 상태
- 독립변수 : 커피브랜드 → 음식 생활 (외생변수) → 반응 (종속변수)
- 휴대폰 사용 시간 → 일상에서 손목을 사용하는 활동(외생변수) → 손목 통증(종속변수)
- # 실습 예시를 보다가 느낀 것 : 조건에는 개입할 수 있는 행동이 들어가야 함/ 그리고 자기 통제는 어려움

# 실험 설계의 종류

### • between-subject: 조건마다 다른 사람을 참여시킨다

### • within-subject: 같은 사람을 모든 조건에 참여시킨다

# between-subject 설계

- 참여자(실험대상) = subject
- 흔히 많이 하는 실험 방식(예: 신약 개발)
- 조건마다 참여자를 **무작위로 할당**하는 것이 중요 ex) 동전던지기처럼 완전 랜덤
- 이중맹검(double blindness): 실험 중 어느 참여자가 어느 조건인지 참
여자도 모르고, 실험자도 모르게 하는 것
- 

### 무작위 할당 : random assignment

- between-subject 설계에서 참여자를 **각 조건에 무작위로 할당**하는 것
- 완전히 무작위로 할당할 경우 한쪽 조건에 참여자가 몰릴 수 있음
    - ex)  투표 결과 전국에 무작위 전화 100건 했는 데, 80건이 강원도일 수도 있음
- 참여자들을 무작위로 섞은 다음 순서대로 조건에 할당할 수도 있음
- 무작위 할당 대신 특정 외생변수가 골고루 섞이도록 할당하기도

# [심슨의 역설](https://m.blog.naver.com/PostView.nhn?blogId=lodastatin&logNo=80115168272&proxyReferer=https%3A%2F%2Fwww.google.com%2F)

- 부분적인 패턴과 전체 패턴이 다를 수 있다

# within-subject 설계

- 한 참여자가 모든 조건에 참여하는 것 (동일한 사람에게 다른 조건들로 계속 실험) / between은 조건 마다 다른 참여자가 있음
    - ex) 버티컬 마우스를 쓰는 집단/안쓰는 집단 → between
    - ex) 한 사람이 버티컬 마우스/일반 마우스 → within
- 외생변수를 완벽히 통제할 수 있음 : 큰 장점 (비트윈은 할 수 없음)
- 참여자가 실험 조건을 눈치채고 영향을 받을 수 있음 → 단점
- 모든 종류의 실험에 가능한 것은 아님(예: 신약개발)  → 단점
- 예)
    - between 맥주를 먹느냐 안 먹느냐 : 그룹 a(채식주의자) 그룹 b(고기덕후) → 외생변수 통제가 어려움
    - within 맥주를 먹느냐 안 먹느냐(한사람): 통제가 가능

# 순서 효과 : order effect

- (wsd의 또다른 단점)
- 참여한 조건의 순서가 실험에 영향을 미치는 것
- 이월 효과 carryover: 이전 조건이 후속 조건에 영향
    - 연습 효과 : 앞의 조건이 이미 연습이 되어 버림
    - 피로 효과 : 앞의 조건을 열심히 했는 데 뒤의 조건은 대충,,,
    - 대조 효과

# Counterbalancing : 역균형법, 상쇄

- 해결법
- 두 방법 : 실험에서 상쇄를 걸어주거나 분석에서 걸어주거나!
- 조건들의 순서에 균형을 맞추면 된다.
- 수준이 a와 b라면, 수준의 효과럴 a-b,b-a 순서로만 확인하는 게 아니라 a-b-b-a로 순서효과를 각 수준에 분배한다
- 실험 상쇄
    - 무작위 : ABC, ACB, BAC, BCA, CAB, CBA
    - 라틴 스퀘어(마방진) : 순서 자체는 고정이나 무엇을 먼저 할 지만 달라짐
        - ABC
        - BCA
        - CAB # 같은 줄에 똑같은 알파벳이 안 들어감
        - 순서를 다 랜덤으로 하면 조건이 커질수록 복잡하니까 abc처럼 순서 자체를 고정으로 두지만, 무엇을 먼저 할 지만 달라지게 하자
- 분석 상쇄
    - 사람들에게 '당신은 지금 얼마나 행복하십니까?' 라는 질문과, '최근 일주일 동안 즐거운 일을 몇 번이나 경험하셨습니까?' 라는 질문을 한다고 가정해 봅시다. 이 중 어떤 질문을 먼저 하느냐에 따라 결과가 매우 달라질 수 있습니다. 대개 전자를 먼저 하는 것보다, 후자를 먼저 했을 때 앞의 질문에 대해 '더 행복하다'고 보고할 가능성이 높습니다. 자신의 행복도를 평가할 때 사용할 수 있는, 긍정적인 근거들을 더 많이 떠올릴 수 있기 때문입니다.

        심리학자들은 이와 같이 실험/설문 등의 순서에 따라 결과가 달라지는 현상을 '순서효과'(order effect)라 부릅니다. 이것은 실험이나 설문 과정에서 고려해야 할 중요한 사항입니다. 

        → 순서효과가 실제로 있을 것으로 예상될 때, 연구자들은 '상쇄'(Counter-balancing)라는 절차를 사용합니다.  앞의 설문조사를 만들 때, '당신은 지금 얼마나 행복하십니까?' 라는 질문을 앞/뒤에 배치한 설문지를 각각 만든 후, 설문 참가자들을 반으로 나누어 각각의 설문지를 나누어 줍니다. 만약 참가자들의 반응이 문항의 배열 순서에 따라 차이가 난다면, 순서 효과가 있는 것으로 판단할 수 있습니다. 이럴 때는 결과를 해석할 때 매우 조심해야 합니다. 

# !!!!! 두 집단의 평균 차이 !!!!!

- 같은 모집단에서 두 번 샘플링하면 약간 다른 샘플이 만들어짐
- 실험에서 각 조건들은 같은 모집단에서 샘플링된 것인가(=실제로는 같
음), 아니면 다른 모집단에서 샘플링된 것인가(=실제로 다름)
- 우도의 논리: 같은 모집단에서 샘플링했을 때(가정) 이런 차이가 관찰될
수 있을까?
- 계산하는 방법 → 신뢰 구간을 구한다

# 부트스트래핑을 이용한 평균 차이 검증(1)

- 집단을 무시하고 데이터를 모두 섞는다(동일한 모집단 대용)
- 무작위로 두 집단을 샘플링한다 (리샘플링)
- 집단 간 차이를 구한다
- 차이의 신뢰구간을 구한다

# 부트스트래핑을 이용한 평균 차이 검증(2)

- 관찰된 차이가 95% 신뢰 구간 안쪽인 경우 → 이 정도 차이는 같은 모집단에서도 샘플링하다보면 95%의 경우에는 나올 수 있는 차이
- •관찰된 차이가 95% 신뢰 구간 바깥쪽인 경우 → 이 정도 차이는 같은
모집단에서 샘플링하면 5% 이하의 경우에나 나올 정도의 차이
- 신뢰수준은 필요에 따라 조정(예: 99.9% 등)

실제 실험: 무작위로 나눈다 → 조건마다 다르게 → 차이를 구함 (1.53정도 나옴)

분석 가정 : 정말로 조건마다 다를까..? 

가정: 무작위로 나눈다 → 조건마다 다르게 안해버림  그냥 반으로 나누기 (무작위로 둘로 나누기) 다이렉트로 차이 구해버리기 

그리고 그 무작위로 나눈 두 집단의 평균 차이 구하기 (+- 1.73정도 나옴) 

→ 아무것도 안해도 그냥 1.73정도 차이는 나옴. 그러니까 실제 실험이 형편없는 결과. 그냥 사람들을 나누어도 나오는 차이. 그니까 '조건마다 다르게'가 의미가 없음. 가정의 결과보다는 더 커야 함. = 조건마다 다르다고 안 봄. 똑같네 ㅎ 조건이 결과에 영향을 미치지 않는다. 

# 단방 검증과 양방 검증

- **양방 검증** : 신뢰 구간을 정할 때 **양쪽 극단을 제외**하고 정함
    - 신뢰 수준 95%일 경우, 상위 2.5%와 하위 2.5%를 제외
- **단방 검증** : 신뢰 구간을 정할 때 **한 쪽 극단만 제외**
    - 신뢰 수준 95%일 경우 상위 5%만 제외하거나 또는 하위 5%만 제외
- 목적에 따라 구간을 정하는 법이 달라짐
    - 예: 신약의 경우 무조건 위약(플라시보)보다 효과가 좋아야 하므로 단방 검증 → 실제로 임상시험 할 때는 양방 검증함 (의심하니까)
    - 단방검증을 하고 싶을 때 신뢰구간을 97%로 바꾸면 됨.
    - 그치만 보통 **양방검증**을 함

# 오류의 종류

[오류의 종류](https://www.notion.so/b36828851c7d40a089fb9b9f0adc46d9)

# 신뢰 수준과 유의 수준(오류)

- 신뢰 수준 = 100% - 유의 수준
- 신뢰 수준 = 95%이면 유의 수준 = 5% / 99%이면 유의 수준 = 1%
- 유의 수준 = 1종 오류의 확률
- 학술 논문은 유의 수준을 정해놓고 함. (20편 중 한편은 틀린다)
- 적당한 유의수준? → 그냥 보통 95%를 쓴다
- 하지만 비즈니스에선 정할 수 있음. 비용을 가지고!
    - 불량 검사 → 정상제품 불량 → 폐기 (비용)

        →불량인데 합격 → 소비자 빡침→ 비용

        어차피 비용은 드니까 2g → 불량 폐기 인 기준을 3g으로 올리면 

        폐기 비용은 줄어듬. (대신 소비자 빡침이 늘겠지,,) 이 때 발생하는 비용을 비교해서 정하게 됨. → 하,, 근데 이렇게 까지 해야할까..? 라는 생각 ㅎㅎ 

# 검정력

- 2종 오류를 범하지 않을 확률
- 검정력이 높아지려면,,,
    - 유의 수준이 높다(신뢰 수준이 낮다)
    - 샘플이 크다
    - 효과 크기가 크다

# 효과 크기