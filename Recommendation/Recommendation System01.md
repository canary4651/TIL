# 추천 시스템

### Introduction to Recommender Systems

### 목표

- 1. 추천분야에대한기초적인지식전달
    - 추천알고리즘의분류및평가방법에대한지식
    - 추천 분야에서 데이터 분석가의 역할
- 2. 간단한영화추천시스템만들어보기

### 정보 필터링

- 정보의 양은 폭증함에 따라 정보 소비자가 '원하는' 정보를 얻는데 시간과 노력이 많이 필요
- 정보 소비자에게 원하는 정보를 쉽게 얻도록 도와주는 분야
- 정보 필터링의 대표적인 분야
    - 검색
    - 추천 시스템

### 추천 시스템

- 정보 소비자가 "원하는" 정보를 찾아 소비자에게
추천하는 시스템
- 검색과의 차이점
    - 검색은 소비자가 관심사를 표현하는 "검색"이라는 행위를 해야함 (active)
    - 추천은 특별한 행위 없이도 정보 전달이 가능 (passive)

### 추천 시스템 분류

- 여기에 분류한 정보 말고도 더 있음
- **시나리오에 따른 분류**
    - 연관된 아이템 추천
        - 현재 소비되고 있는 아이템과 연관된 아이템을 추천
    - **개인화 아이템 추천**
        - 소비 중인 아이템이 없더라도, 개인의 관심사를 찾아 소비할 만한 아이템을 추천
- **피드백 종류에 따른 분류**
    - 실제로 중요하게 생각하는 추천 시스템
    - 명시적 피드백을 사용하는 추천 시스템
        - 영화 평점 / 좋아요, 싫어요와 같이 소비자가 "명시적으로" 자신의 선호를 표현한 데이터 = 명시적 피드백
        - 단점 : 데이터가 많지 않음 (아이템 수 대비)
    - 암시적 피드백을 사용하는 추천 시스템
        - 좋아하는 지, 싫어하는 지는 모르겠는 데 많이 뭉쳐놓으면 보이는 게 있음
        - 대부분 암시적 피드백을 많이 사용함
        - 웹페이지 접속기록(상품),음악 청취 기록 같이 소비자가 명시적으로 표현하진 않은 피드백 = 암시적 피드백
        - 단점 : 큰 데이터를 처리하려면 시간이 오래 걸림 / 노이즈 데이터가 끼어있음 (핸들링을 잘 해야함)
- **업데이트 주기에 따른 분류**
    - 정적 추천 시스템 (오늘 우리가 구현할 시스템)
        - 특정시점의 데이터를 사용해 추천결과를 계산하는 추천방식
        - 단점 : 사람들은 새로운 데이터를 원함
        - 별로 안 좋아하는 컨텐츠여도 새로운 것을 보여주는 게 유저 만족도를 높힘
    - 동적 추천 시스템
        - 지속적으로 사용자의 데이터를 받아 추천 결과를 업데이트하는 추천 방식
- 실제로는 다양한 추천 로직이 섞인 하이브리드 추천 시스템을 많이 사용

### 추천 알고리즘

- **Knowledge-based Filtering**
    - 편견에 입각한 추천 시스템
    - 유저에 대한 정보가 거의 바닥일 때
    - 추천하고자 하는 분야의 도메인 지식을 활용해 추천하는 방식
    - e.g. 성별/연령별로 많이 팔리는 상품들을 모아 추천에 활용
- **Content-based Filtering**
    - 추천 하려는 아이템의 콘텐츠 정보를 분석하거나 정리
    된 메타 정보를 활용해 콘텐츠별로 특징 정보를 만들고
    이를 활용해 추천
    - e.g.액션장르영화페이지하단에다른액션장르의
    영화를 추천
- **Collaborative Filtering**
    - 추천 시스템의 가장 대세
    - 제일 리소스가 덜 들기도 함 (텍스트 데이터)
    - 소비자의 아이템 소비 이력을 사용해 소비하지 않은 새로운 아이템을 추천
    - e.g. 영화 감상 이력을 바탕으로 소비자가 좋아할 만한
    영화를 찾아내서 추천

### 추천 알고리즘 평가 방법

- 오프라인 평가 (Offline Evaluation)
    - 사용자의 아이템에 대한 선호 기록과 추천 시스템이
    추천한 결과를 비교하여 추천 품질을 평가
    - 특징
        - 별다른비용지출없이수집된데이터만사용하여평가가가능
        - 여러모델을동시에평가할수있음
        - 선호기록이 기존에 사용 중인 추천모델에 영향을 받을 수 있으므로 실제 사용자의 만족도와 평가 결과가 다를 수 있음
        - 단점 : 실제로 잘 되는 건지 안 되는 건지 확신할 수 없음 (기존 추천 결과를 잘 때려 맞춰서 잘 나오는 건지, 진짜 추천이 잘 되는 건지 알기가 애매모호함)
        - 정말 평가를 잘 하려면 온라인 평가를 해야함
        - 해킹이 가능해서 점수를 높이는 건 쉽게 할 수도 있음
        - 논문은 대부분 오프라인 평가를 사용함 (내보낼 서비스가 없으니까, 오픈된 데이터를 가지고)
- 온라인 평가 (Online Evaluation)
    - 만들어진 추천 시스템을 직접 사용자에게 노출시켜 사용자의 반응을 수집하여 추천 품질을 평가
        - A/B 테스트나 통계적인 샘플링을 적용
    - 특징
        - 시간의 흐름에 따른 평가가 가능하고 실제 사용자의 만족도를 측정한다는 측면에서 정확한 방식
        - 비용이 비싼 평가 방식(사용자의만족도감소가능성등)
        - 몇 명을 희생양 삼아서 달림 ㅎ
        - 브런치 앱을 잘 안사용함

### 실습

- 1. 영화 메타데이터(metadata.csv)를 pandas DataFrame으로 불러오기
- 2. 평점 데이터(ratings-train.csv)를 pandas DataFrame으로 불러오기
- 3. 평점의 분포를 히스토그램으로 그려보기
- 4. 이외의 EDA를 통해 데이터의 패턴을 발견해보기

# similar_users 함수 만들기

![](Untitled-f042efd4-2d13-4283-95c8-b856d9740078.png)